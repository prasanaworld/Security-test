<!DOCTYPE html>
<html>
<head>
  <meta charset=UTF-8>
<meta http-equiv="Content-Security-Policy" content="script-src chrome-extension://lalkbmfcljnpppfepafccjphbhibgpnb/ safari-extension://com.symantec.idsafe-0000000000/ ms-browser-extension://MSG_extensionName___1BA6DFA447574F49AF1EF3CE59B963C9/ 'unsafe-inline' 'unsafe-eval' ">
  <title>Security Test - XSS</title>
  <style>
    * {
      padding: 10px;
    }
    form {
      margin:  0 auto;
      width: 500px;
      display: table-cell;
    }
  </style>
</head>
<body>
  <svg xmlns="http://www.w3.org/2000/svg" onload="alert('Proofpoint acquire Tessian, but they need Pentesters')"/>
  
  <script>
    function replacer(input = "") {
      return input.replace(/[?#]/g,'');
    }
    function getQueryStringValue (key) {  
      return decodeURIComponent(window.location.search.replace(new RegExp("^(?:.*[&\\?]" + encodeURIComponent(key).replace(/[\.\+\*]/g, "\\$&") + "(?:\\=([^&]*))?)?.*$", "i"), "$1"));  
    } 
    window.addEventListener('load', () => {
      const hashValue = replacer(window.location.hash);
      const searchValue = getQueryStringValue("redirect");

      if(hashValue === 'attack') {
        window.location.href = searchValue;
      }

    });
  </script>
</body>
</html>
